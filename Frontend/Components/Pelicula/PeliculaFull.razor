@using Frontend.Components.Genero
@using Frontend.Components.Personaje
@inject NavigationManager nav
@inject IPeliculasService pcService
<MudCard>
    <MudCardContent>
        <MudText>@pelicula.Titulo</MudText>
        <MudImage Src=@pelicula.Imagen></MudImage>
        <MudText>Raiting @pelicula.Calificacion</MudText>
        <MudText>Publicado: @pelicula.FechaCreacion</MudText>
        @foreach (var item in pelicula.Generos)
        {
            <GeneroComponent genero="item"></GeneroComponent>
        }
        @foreach (var item in pelicula.Personajes)
        {
            <PersonajeSimple personaje="item"></PersonajeSimple>
        }
    </MudCardContent>
    <AuthorizeView>
        <MudCardActions>
            <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="OnClickEdit">Edit</MudButton>
            <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="OnClickDelete">Delete</MudButton>
        </MudCardActions>
    </AuthorizeView>

</MudCard>

@code {
    [Parameter]
    public PeliculaFullDTO pelicula { get; set; }

    [Parameter]
    public string id { get; set; }
    private async Task OnClickDelete()
    {
        var result = await pcService.DeletePelicula(int.Parse(id));
        nav.NavigateTo("/");
    }
    private async Task OnClickEdit()
    {
        nav.NavigateTo($"/peliculas/edit/{id}");
    }
}
